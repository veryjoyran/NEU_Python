# 二手房查询与房价预测系统 - 控制台版本

## 项目简介
本项目是一个基于控制台的二手房查询与房价预测系统。用户可以通过输入查询条件筛选二手房数据，并对缺失的房价数据进行填充（均值填充或线性回归预测填充）。系统还提供多种排序方式，方便用户直观地查看结果。最终结果可以保存到 Excel 文件中。

---

## 功能概述
- **数据加载**：从 Excel 文件加载二手房数据，显示加载进度。
- **条件查询**：支持按地址关键词筛选房源数据。
- **缺失值处理**：支持两种填充方式：
  1. **均值填充**：使用房价的平均值填充空值。
  2. **线性回归预测**：基于其他特征预测缺失的房价并填充。
- **数据排序**：支持以下排序方式：
  - 按收藏数量降序排序。
  - 按房价升序排序。
  - 按房价降序排序。
- **结果保存**：将筛选和排序后的结果保存为 Excel 文件。

---

## 环境要求
- Python 3.7+
- 依赖库：
  - `pandas`
  - `openpyxl`
  - `tqdm`
  - `scikit-learn`

---

## 使用方法
1. **准备数据文件**：
   - 将二手房数据保存为 Excel 文件（例如：`house_data_20240430.xlsx`），并确保文件格式正确。

2. **运行程序**：
   - 在终端运行以下命令：
     ```bash
     python main.py
     ```
   - 根据提示输入查询条件和操作选项。

3. **操作说明**：
   - **查询**：输入地址关键词筛选房源。
   - **缺失值填充**：
     - 选择 `1` 使用均值填充房价空值。
     - 选择 `2` 使用线性回归预测房价空值。
   - **排序**：
     - 选择 `1` 按收藏数量降序排序。
     - 选择 `2` 按价格升序排序。
     - 选择 `3` 按价格降序排序。
   - **保存结果**：筛选和排序后的数据将自动保存为 `filtered_results.xlsx`。

4. **查看结果**：
   - 打开生成的 Excel 文件 `filtered_results.xlsx` 查看查询结果。

---

## 文件说明
- **`main.py`**：主程序脚本。
- **`house_data_20240430.xlsx`**：二手房测试数据文件。
- **`filtered_results.xlsx`**：保存的查询结果文件。

---

## 注意事项
- Excel 文件的列名需要与程序中的列名对应。如果需要修改，请同步更新代码中的 `column_translation` 字典。
- 由于获取到的数据中并不包含户型等数据，所以主要参考为搜索的地区，如果有更加合适的数据，在模糊查询中增加即可
- 由于数据量较大，加载数据可能需要一定时间，请耐心等待，在运行main.py之后，等待10s左右会出现进度读条
---

## 数据获取  
数据链接：http://www.sanliudata.com/dataset    
下载链接：https://www.aliyundrive.com/s/ztcTWLVxfio